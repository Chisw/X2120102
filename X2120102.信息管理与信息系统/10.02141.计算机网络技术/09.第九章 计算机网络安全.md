# 第九章 计算机网络安全

## 第一节 计算机网络安全概论

### 一、计算机网络面临的威胁

1. 计算机网络实体面临的威胁
  - 硬件方面

2. 计算机网络系统面临的威胁
  - 窃听
  - 重传
  - 伪造
  - 篡改
  - 非授权访问
  - 拒绝服务攻击
  - 行为否认
  - 电磁截获
  - 人员疏忽

3. 恶意程序的威胁
  - 计算机病毒
  - 网络蠕虫
  - 特洛伊木马
  - 逻辑炸弹

### 二、计算机网络安全的基本概念

涉及计算机科学、通信技术、密码技术、应用数学和信息论等多门类知识的综合性学科

### 三、计算机网络安全的目标

1. 机密性：不泄露
2. 完整性：不被修改、破坏、丢弃
3. 可用性：方便获得
4. 不可抵赖性：使用凭据
5. 可控性：遵守法律法规

### 四、计算机网络安全的层次及内容

1. 物理安全：地震、水灾、火灾、雷电、偷盗、破坏、误操作
2. 路基安全：口令密码、软件加密、权限控制
3. 操作系统安全：用户权限控制、漏洞修复
4. 联网安全：访问控制策略、加解密

### 五、计算机网络安全的主要技术

1. 加密技术：将明文，利用密钥，通过加密算法变成密文，需要时再解密
2. 鉴别技术：防范攻击、病毒
3. 防火墙技术：内外部网络隔离
4. 访问控制技术
5. 防病毒技术
6. 监控审计技术
7. 备份技术

### 六、常用的计算机网络安全措施

1. 物理隔离：线路
2. 逻辑隔离：软硬件，主要是防火墙
3. 加密通信
4. 专用或虚拟网络
5. 病毒防御
6. 身份认证
7. 网络管理和审计

## 第二节 信息加密技术

### 一、信息加密的概念

```
P = D(E(P))
```

只要给予足够的时间和配备足够强大的计算资源，几乎任何密码体制都是可以破译的

因此，人们更加关心的是在一定的时间和计算资源限制下，密码体制是否可以被破译

如果某一密码体制在有限的时间内被可以使用的计算资源破译，则称该密码体制在计算上是不安全的

### 二、密码体制的分类

1. 对称加密
  - 单密钥
  - 加密算法公开
  - 密钥生成于发送方或可信第三方
  - 最有影响力：1977 DES

2. 非对称加密
  - 双密钥
  - 每次生成密钥时生成一对
  - 加密密钥可公开，公钥
  - 解密密钥不公开，私钥
  - 加解密算法也公开
  - 产生原因：
    - 密钥管理和分配问题
    - 满足数字签名需求：用户获得密钥对后，公开加密密钥，其他用户加密后传回，用户自己解密
  - 优点：可公开加密密钥
  - 最著名：1978 RSA

### 三、密钥的分配

1. 对称密钥的分配
  - n 个用户，需要 n * (n - 1) 个密钥，每两个共用一个，再 / 2
  - 密钥分配服务器 KDC

2. 非对称密钥的分配
  - 认证中心 CA
  - 绑定公钥跟 IP 的关系（证书）
  - 标准：ITU-T X.509 协议

### 四、信息加密方式

1. 链路加密
  - 网络中相邻两个结点之间传输加密，逐个加解密
  - 要求每个结点都安全是很难的，密钥管理分配复杂

2. 结点加密
  - 是对链路加密的一种补充
  - 结点中使用不同密钥加密保存，不出现明文

3. 端到端加密
  - 源点加密，终点解密
  - 便宜、管理维护方便、算法选择度高
  - 但源地址、目的地址、路由等控制信息不能加密

### 五、数字签名

实现功能：

1. 接收方可以验证发送方所宣传的身份
2. 发送方在发出数据后不能进行否认
3. 接收方不可能自己编造信息

方法：

1. 对称密钥签名
2. 公钥签名：E(D(P)) = P

### 六、鉴别技术

报文鉴别

主要手段：数字签名

报文过长时：报文摘要 MD

MD + 数字签名：报文鉴别码 MAC

报文摘要原理：利用单向哈希函数

MD5：得出固定长度 128 位报文摘要

1. 对任意长度的报文按模 2^64 计算其余数，将得到的结果追加在报文后面
2. 在报文和余数之间进行填充，使得填充后的总长度为 512 的倍数
3. 将总的报文分割成若干个 512 位的数据块，每个数据块再分割成 4 个 128 位的子数据块，依次送到不同的哈希函数进行 4 轮运算。每一轮又都按 32 位的小数据块进行复杂运算，一直到最后计算出 128 位的报文摘要

安全散列算法 SHA，原理相似，采用 160 位报文摘要

## 第三节 Internet 中的安全协议

### 一、IPsec 协议

由 IETF 设计，工作在网络层的安全通信机制

是一个协议组，主要对 IP 数据报进行加密，确保目的站点收到时能确信为源 IP 发送

IPsec 体系中，源主机和目的主机之间需要建立一条网络层的逻辑连接，称为安全关联 SA

就将面向无连接的 Internet 网络层变成面向连接的

SA 是一个单工连接，每个SA 都有一个与之关联的安全标识符

在进行安全通信时，每个分组都携带相应的安全标识符，目的主机利用该安全标识符来查询数据报中的密钥和其他相关信息

IPsec 体系设置了两种安全控制机制：

1. 鉴别首部 (Authentication Header， AH)协议
  - RFC 2402
  - 提供源站点的鉴别和数据完整性服务，但不能进行数据加密
  - 结构：
    - 下一个首部：8b
    - 有效载荷长度：8b
    - 保留：15b
    - 安全参数索引：32b
    - 序列号：32b
    - 报文鉴别码 MAC：可变长度，但必须是 32b 倍数
  - 传输模式时，AH 首部被插在数据报中，紧跟在 IP 首部之后，位于需要保护的上层协议之前，如 TCP 或 UDP 首部
  - 隧道模式时，将所保护的数据报完全封装起来，在 AH 头之前另外添加一个新的 IP 首部

2. 封装安全有效载荷 (Encapsulation Security Payload, ESP)协议
  - RFC 2406
  - 还提供数据加密服务
  - 结构：
    - SPI
    - 序列号
    - 载荷数据
    - 填充：8b
    - 填充长度：0 ~ 255B
    - 下一个首部
    - 报文鉴别码 MAC
  - 传输模式时，保护的是 IP 数据报的载荷，如 TCP、 UDP 和 ICMP 等数据段
  - 隧道模式时，保护的是整个 IP 数据报

AH 和 ESP 可以单独使用，也可以嵌套使用

IPsec 体系中存在两种工作模式：

1. 传输模式：保护 IP 数据报的上层协议数据
  - IPsec 适用于主机到主机间的安全通信，都需要运行 IPsec 协议

2. 隧道模式：对整个 IP 数据报进行保护
  - 只需要网络中的路由器运行 IPsec 协议
  - 常用来实现虚拟专用网 VPN

### 二、安全套接字层协议 (SSL) / 传输层安全协议 (TLS)

IPsec 解决了 Internet **网络层**的数据加密和认证问题

随着发展，端到端的数据通信业务对安全性的要求越来越高

解决这些问题主要依靠工作在**传输层**的安全协议

安全套接字层协议 SSL 由网景于 1994 推出，v3.1 开始被 IETF 接管并更名为 传输层安全协议 (TLS)

SSL/TLS 协议提供的安全目标：

1. 认证性：防身份伪造
2. 机密性：防窃听
3. 完整性：借助 MAC 保障完整，防止篡改
4. 重放保护：隐式序列号防止重放攻击

基本思想：

采用公钥加密，客户端先向服务端索要公钥，然后加密信息发给服务端，服务端私钥解密

两个问题：

1. 如何保证公钥不被篡改
2. 公钥加密计算量大

SSL/TSL 解决办法：

1. 服务器将公钥放在数字证书中传给客户端，证书可信即公钥可信
2. 每次对话生成“对话密钥”，对称加密速度快

SSL/TSL 基本过程：

1. 客户端向服务端索要公钥并验证
2. 双方生成对话密钥
3. 通过对话密钥加密通信

前两个步骤称为握手阶段

具体：

- 首先浏览器向服务器发出请求，询问对方支持的对称加密算法和公钥加密算法；服务器回应自己支持的算法
- 浏览器选择双方都支特的加密算法，并请求服务器出示自己的证书：服务器回应自己的证书
- 浏览器隨机产生一个用于本次会话的对称加密密钥，并使用服务器证书中附带的公钥对该钥匙进行加密后传递给服务器
- 服务器为本次会话保持该对称加密密钥
- 由于第三方不知道服务器的私钥，即使被截获了数据也无法解密
- 公钥加密使得任何浏览器都可以与服务器进行加密会话
- 浏览器使用对称加密密钥对要发送的 HTTP 请求消息加密后传送给服务器
- 服务器使用该对称加密密钥进行解密
- 服务器使用对称加密密钥对 HTTP 响应消息加密后传送给浏览器
- 浏览器使用该对称加密密钥进行解密

## 第四节 防火墙技术

### 一、防火墙的基本概念

防火墙（Firewall）的原意是指古代人们在建筑物之间修筑的墙，防止火灾的蔓延

人们考虑在内部网络或者计算机与 Internet 之间设置一个安全屏障

防火墙是位于被保护网络或主机与外部网络之间执行访问控制策略的一个或一组系统

包括硬件和软件，通过控制和监测网络之间的信息交换和访问行为来实现对网络安全的有效管理

防护功能：

1. 过滤进出网络的数据
2. 管理进出网络的行为
3. 封堵需要禁止的业务
4. 记录进出网络的信息和动作
5. 对网络攻击进行检测和警告等

### 二、防火墙技术的分类

1. 包过滤技术
  - 检测 IP 数据报各部分是否合法
  - 对 IP 数据拫进行选择的依据称为过滤逻辑
  - 防火墙中所保存的过滤逻辑集合称为访问控制列表(Access Control List, ACL)
  - 根据 ACL 逐条对比
  - 逻辑简单、便宜、易安装
  - IP 易假冒，过滤失效，只能鉴别网络层和传输层的有限信息

2. 代理服务技术
  - 代理服务器就在内网与外网之间发挥了中间转接和隔离的作用，因此也被称为代理服务防火墙
  - 工作在应用层
  - 分类：
    - 应用层网关防火墙：
      - 基于软件，安全性能较高
      - 对流量进行记录和控制
      - 处理速度慢，对用户不透明
    - 电路层网关防火墙

3. 状态检测技术
  - 又称：动态包过滤防火墙
  - 设置专门网络安全策略软件——检测引擎
  - 对比：
    - 包过滤：只针对某个独立数据报，不关心之前之后，是否通过取决于自身包含的信息
    - 动态包过滤：将同属于一个连接的数据报作为一个整体的数据流看待，构成连接状态表，通过过滤逻辑和状态表共同配合，对表中的各个连接状态因素加以识别，具有更好的灵活性和安全性

4. NAT 技术
  - 网络地址转换协议是将内都私有 IP 地址转换成合法的公用 IP 地址
  - 防火墙利用此特性使外部网络无法了解内部网络的地址分布，无法通过指定 IP 地址对具体计算机发起攻击
  - 同事，与外部网络的通信只能由内部网络主机发起，提高内部网络安全性

### 三、个人防火墙

可以把个人防火墙形象地比作用户计算机上建立的一个虚拟网络接口，位于操作系统和网卡之间，对通信进行检测和控制

功能：

1. IP 数据报过滤功能
2. 安全规则的设定
3. 对网络攻击的拦截功能
4. 网络访问控制功能
5. 日志记录功能
6. 网络快速切断/恢复功能
7. 更新升级

产品：

- Zone Narn Pro
- Comodo Firewall
- McAfee Desktop Firewall
- 诺顿个人防火墙
- 金山网镖
- 360网络防火墙
- 瑞星个人防火墙

## 第五节 计算机病毒与恶意代码的防范

计算机病毒：编制或者在计算机程序中插入的破坏计算机功能或者毁坏数据，影响计算机使用，并能自我复制的一组计算机指令或程序代码

早期的计算机病毒主要是通过软盘传播

逐渐融合了木马、网络蠕虫和网络攻击等技术

目前计算机病毒的传播途径主要是通过互联网中的数据和软件下載、电子邮件中的附件打开，以及移动存储设备的交叉使用等

木马程序通过将自身伪装成其他正常软件来吸引用户下载并执行

网络蠕虫是一种可以自我复制的完全独立的程序

对个人计算机进行病毒防范，最直接的方法就是安装和使用杀毒软件

- 360 杀毒
- 百度杀毒
- 瑞星杀毒
- 卡巴斯基
- 金山毒霸

## 第六节 保障网络安全的非技术手段

### 一、养成良好的网络操作使用习惯

1. 及时安装系统补丁
2. 及时进行数据备份
  - 位置：本地、异地
  - 手段：人工、专门软件
  - 需要备份的分类：
    - 个人制作和编辑的文件
    - 常用软件和驱动
    - 系统生成的个人用户信息

### 二、学习井遵守互联网安全的相关法律法规

1. 《中华人民共和国计算机信息系统安全保护条例》
2. 任何组织或者个人不得利用计算机信息系统从事危害国家利益、集体利益和公民合法利益的活动，不得危害计算机信息系统的安全
3. 从事国际联网业务的单位和个人，应当遊守国家的有关法律和行政法规，严格执行安全保密制度，不得利用国际联网从事危害国家安全、泄露国家秘密等违法犯罪活动，不得制作、查阅、复制和传播妨碍社会治安的信息和淫秽色情等信息
4. 任何组织或个人，不得利用计算机国际联网从事危害国家安全、泄露国家秘密等犯罪活动：不得利用计算机国际联网查阅、其制、制造和传播危害国家安全、妨碍社会治安和淫秽色情信息，若发现上述违法犯罪行为和有害信息，应及时向有关主管部门报告
5. 任何组织或个人，不得利用计算机国际联网从事危害他人信息系统和网络安全，侵犯他人合法权益的活动
6. 国际联网用户应当服从接入单位的管理，遵守用户守则；不得擅自进入未经许可的计算机系统，篡改他人信息：不得在网络上散发恶意信息，冒用他人名义发出信息，侵犯他人隐私：不得制造和传播计算机病毒，以及从事其他侵犯网络和他人合法权益的活动

## 思考与练习

1. 请简述计算机网络面临的威胁主要来自哪些方面。
2. 请简述对于不同的计算机网络参与者，计算机网络安全有哪些不同的含义和任务。
3. 计算机网络安全的基本目标有哪些？
4. 请简述计算机网络安全包含的层次及各层次的基本内容。
5. 典型的计算机网络安全技术有哪些？
6. 假设明文为 P，加密算法为 E，解密算法为 D，请利用 P、E 和 D 写出信息加密需要满足的条件。
7. 在对称密钥密码体制和非对称密钥密码体制中，加密密钥、解密密钥、加密算法和解密算法哪些是保密的，哪些是公开的？
8. 请简述密钥分配中心 KDC 进行密钥分配的主要过程。
9. 在非对称密钥体制中，接收方如何判断接收到的公钥和用户身份是否一致？
10. 计算机网络通信中，信息加密的方式有哪些？
11. 数字签名技术的基本功能有哪些？数字签名的实现方法有哪两种？
12. 请简述报文摘要 MD 的基本思想。
13. 请简述 IPsec 体系中传输模式和隧道模式的含义。
14. SSL/TSL 协议的安全目标有哪些？
15. 请简述用户使用支持 SSL/TSL 的浏览器访问万维网的基本过程。
16. 根据工作原理的不同，防火墙技术主要包括哪些技术？
17. 一个完整的个人防火墙产品应包含哪些基本功能。
18. 良好的计算机及互联网操作使用习惯主要包括哪些方面？
19. 请简述作为一个互联网用户，应该遵守哪些法律法规。
