# 第七章 回归分析法

回归分析法：通过研究两个或两个以上的变量之间的相关关系对未来进行预测的一种数学方法 🎯

不仅提供了建立变量关系之间相关关系的数学表达式的一般途径，还对经验性公式的适用性进行分析，使之可以有效地用于预测和控制

## 第一节 概述

### 一、概念

回归一词最早见于生物学

回归：用来描述多个随机变量之间在统计平均意义上趋向于某种较为确定的相互依赖关系，即统计相关关系

- 自变量：带有“原因”性质
- 因变量：带有“结果”性质

相关关系两种类型：

1. 确定关系：自变量绝对决定因变量，数学上可以表达为函数关系
2. 不确定关系：自变量影响因变量但不绝对，只能通过观测数据、数理统计找出规律，数学上通过回归方程

回归方程：用一个适当的数学表达式，说明一个或几个变量变动时，其他变量平均变动的情况

回归分析法解决的两个问题：

1. 确定几个变量之间是否存在相关关系，如存在，找出他们之间适当的数学表达式
2. 根据一个或几个变量的值，预测或控制另一个或几个变量的值，估计可达到的精确度

回归分析与相关分析：既有联系又有区别

1. 两者都是研究及度量变量之间关系的统计方法，广义上相关分析包括回归分析
2. 相关分析探讨变量间关系的密切程度，回归分析探求变量间关系究竟为何种形式

### 二、分类 🎯

按回归方程的不同：

1. 线性回归（基本模型）：线性方程
2. 非线性回归：非线性方程

按自变量个数：

1. 单元回归：一个自变量
2. 多元回归：两个及以上自变量

具体分类：

1. 单元线性回归：一个自变量的线性回归，用于两个变量接近线性关系
2. 多元线性回归：一个因变量同多个自变量的线性关系
3. 非线性回归：
  - a 数学变换变成线性回归（取对数可使乘法变加法）
  - b 多项式回归（直接进行非线性回归）
4. 单元多项式回归：因变量同自变量成多项式函数关系

### 三、工作步骤 🎯

1. 设定回归方程
2. 确定回归系数
3. 相关性检验，确定相关系数
4. 计算预测值及其置信区间

回归分析法进行预测，首先要对各个自变量做出预测，各个自变量可人工控制或预测，且回归方程较符合实际，则有效

为符合实际，应尽可能定性判断自变量的种类和个数，定性判断回归方程的类型

力求掌握充分的高质量数据，再运用一套统计和检验程序，利用数学工具定量计算或改进前两种定性判断

常用概念：

1. 实际值：实际观测到的研究对象的特征值 ![y_i](../img/X2120102.02124.07.01.svg)
2. 理论值：根据得到的数学模型计算出的理论值 ![\widehat{y}_i](../img/X2120102.02124.07.02.svg)
3. 预测值：计算出来的未来理论值 ![y_0](../img/X2120102.02124.07.03.svg)

## 第二节 一元线性回归分析法 🎯

### 一、设定回归方程

x 自变量，y 因变量，绘制散点图

如果大致呈线性关系，则设定回归方程 `y = a + bx`

称直线为 y 对 x 的回归直线，a、b 为回归系数

### 二、确定回归系数

采用最小二乘法，在各点处的偏差的平方和达到最小

变差：一个因变量的某次观测值与这个因变量的平均值的差

> ![y_i-\overline{y}](../img/X2120102.02124.07.04.svg)

总变差平方和：各次观测值变差的平方和，由剩余平方和 Q、回归平方和 U 两部分组成

> ![S_{yy}=\sum_{i=1}^{n}(y_i-\overline{y})^2=Q+U](../img/X2120102.02124.07.05.svg)

最小二乘原则：根据剩余平方和 Q 最小的原则来确定回归系数 a、b

> ![a=\overline{y}-b\overline{x}](../img/X2120102.02124.07.06.svg)

> ![b=\frac{\sum{(x_i-\overline{x})(y_i-\overline{y})}}{\sum{(x_i-\overline{x})^2}}](../img/X2120102.02124.07.07.svg)

或：🎯

> ![b=\frac{\sum{x_iy_i}-\overline{x}\sum{y_i}}{\sum{x^2_i}-\overline{x}\sum{x_i}}](../img/X2120102.02124.07.08.svg)
> ---
> ![\sum{x_i}=x_1+x_2+...+x_i](../img/X2120102.02124.07.09.svg)
>
> ![\sum{x_iy_i}=x_1\cdot{y_1}+x_2\cdot{y_2}+...+x_i\cdot{y_i}](../img/X2120102.02124.07.10.svg)
>
> ![\overline{x}=\frac{1}{i}\sum{x_i}](../img/X2120102.02124.07.11.svg)

### 三、相关性检验

相关性检验：对回归模型描述实际数据的近似程度，也即对所得的回归模型的可信程度进行检验

#### 公式一

> ![r=\frac{\sum{(x_i-\overline{x})(y_i-\overline{y})}}{\sqrt{\sum(x_i-\overline{x})^2\cdot\sum{(y_i-\overline{y})^2}}}](../img/X2120102.02124.07.12.svg)

- 公式来源：数理统计，理论性较强
- 应用范围：只适用于一元线性回归相关系数的计算
- 计算所需数据：全是原始数据及其平均值
- 是否可反映正、负相关：
  - r 为正值，表示 y 与 x 正相关，上升趋势
  - r 为负值，表示 y 与 x 负相关，下降趋势

#### 公式二

> ![r=\sqrt{1-\frac{\sum{(y_i-\widehat{y_i})^2}}{\sum{(y_i-\overline{y})^2}}}](../img/X2120102.02124.07.13.svg)

- 公式来源：方差分析，比较直观
- 应用范围：可用于一元、二元、多元线性回归相关系数的计算
- 计算所需数据：需求出回归方程及理论值 ![\widehat{y}_i](../img/X2120102.02124.07.14.svg)
- 是否可反映正、负相关：r 全为正值，看不出 y 与 x 的正负相关

1. `0 <= |r| <= 1`，当 `|r|` 越接近 1 时，剩余平方和的值越接近于 0，则回归模型描述 y 与 x 的关系的近似程度越好

2. 当 `|r| = 1` 时，完全线性相关
3. 当 `|r| = 0` 时，无线性相关

相关系数临界值与数据组的个数有关

检验表：

- f: 自由度
- α: 显著性水平

置信水平计算：`100(1-α)%`

### 四、预测及其置信区间

> ![y=y_0\pm\sqrt{\frac{\sum{(y_i-\widehat{y}_i)^2}}{n-2}}\cdot{t_{\frac{a}{2}\cdot(n-2)}}\cdot\sqrt{1+\frac{1}{n}+\frac{(x_0-\overline{x})^2}{\sum{(x_i-\overline{x})^2}}}](../img/X2120102.02124.07.15.svg)

## 第三节 多元线性回归分析法

找出主要因素，忽略次要因素

基本形式模型：🎯

> ![y=a+b_1x_1+b_2x_2+...+b_mx_m=a+\sum_{k=1}^{m}b_kx_k](../img/X2120102.02124.07.16.svg)

建立多元线性回归方程的问题也就是求得多个回归系数的问题

## 第四节 非线性回归分析法

可线性化的非线性回归 🎯

经过一定的变量变换之后，可以转化为直线方程：

1. 双曲线
2. 幂函数
3. 指数函数
4. 对数函数
